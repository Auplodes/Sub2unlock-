<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Pro Clone</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { display: flex; height: 100vh; background: #e6eff5; overflow: hidden; }

        /* Sidebar */
        .sidebar { width: 30%; max-width: 350px; background: #fff; border-right: 1px solid #ddd; display: flex; flex-direction: column; }
        .sidebar-header { padding: 20px; background: #2481cc; color: #fff; font-size: 18px; font-weight: bold; }
        .chat-list { flex: 1; overflow-y: auto; }
        .chat-item { padding: 15px; border-bottom: 1px solid #f0f0f0; cursor: pointer; display: flex; align-items: center; }
        .avatar { width: 45px; height: 45px; background: #2481cc; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; margin-right: 12px; font-weight: bold; }

        /* Main Chat */
        .main-chat { flex: 1; display: flex; flex-direction: column; background-image: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png'); background-size: cover; }
        .chat-header { padding: 15px; background: #fff; border-bottom: 1px solid #ddd; font-weight: bold; }
        .messages-container { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        
        .msg { max-width: 70%; padding: 10px; border-radius: 12px; font-size: 14px; box-shadow: 0 1px 2px rgba(0,0,0,0.1); word-wrap: break-word; }
        .sent { align-self: flex-end; background: #effdde; }
        .received { align-self: flex-start; background: #fff; }
        .msg img { max-width: 100%; border-radius: 8px; margin-top: 5px; display: block; }

        /* Input Area */
        .input-area { padding: 15px; background: #fff; display: flex; gap: 10px; align-items: center; }
        input[type="text"] { flex: 1; padding: 12px; border: 1px solid #ccc; border-radius: 8px; outline: none; }
        .file-label { cursor: pointer; font-size: 20px; color: #2481cc; }
        #fileInput { display: none; }
        button { background: #2481cc; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-weight: bold; }

        @media (max-width: 700px) { .sidebar { display: none; } .main-chat { width: 100%; } }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="sidebar-header">Telegram Clone</div>
        <div class="chat-list">
            <div class="chat-item">
                <div class="avatar">G</div>
                <div><h4>Global Group</h4><p>Online</p></div>
            </div>
        </div>
    </div>

    <div class="main-chat">
        <div class="chat-header">Global Group</div>
        <div class="messages-container" id="msgBox"></div>
        <div class="input-area">
            <label class="file-label" for="fileInput">ðŸ“Ž</label>
            <input type="file" id="fileInput" accept="image/*">
            <input type="text" id="msgInput" placeholder="Write a message...">
            <button id="sendBtn">Send</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
        import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-storage.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD8Pjl4LDq7mMpo9QknRIIl_D_Vu7jsYTM",
            authDomain: "telegram-clone-b6d99.firebaseapp.com",
            projectId: "telegram-clone-b6d99",
            storageBucket: "telegram-clone-b6d99.firebasestorage.app",
            messagingSenderId: "224299152451",
            appId: "1:224299152451:web:a733e7e032e859b5e250f6",
            measurementId: "G-SQRLD4Z2WC"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const storage = getStorage(app);
        
        const msgBox = document.getElementById('msgBox');
        const msgInput = document.getElementById('msgInput');
        const fileInput = document.getElementById('fileInput');
        const sendBtn = document.getElementById('sendBtn');
        const myId = Math.random().toString(36).substring(7);

        // Function: Send Message or Image
        async function sendMessage() {
            const text = msgInput.value;
            const file = fileInput.files[0];
            let imageUrl = null;

            if (text.trim() === "" && !file) return;

            // Agar image hai toh upload karein
            if (file) {
                const storageRef = ref(storage, 'images/' + Date.now() + "_" + file.name);
                await uploadBytes(storageRef, file);
                imageUrl = await getDownloadURL(storageRef);
            }

            await addDoc(collection(db, "messages"), {
                text: text,
                imageUrl: imageUrl,
                senderId: myId,
                timestamp: serverTimestamp()
            });

            msgInput.value = "";
            fileInput.value = "";
        }

        // Listen for Messages
        const q = query(collection(db, "messages"), orderBy("timestamp", "asc"));
        onSnapshot(q, (snapshot) => {
            msgBox.innerHTML = "";
            snapshot.forEach((doc) => {
                const data = doc.data();
                const msgDiv = document.createElement('div');
                msgDiv.className = `msg ${data.senderId === myId ? 'sent' : 'received'}`;
                
                let content = '';
                if(data.imageUrl) content += `<img src="${data.imageUrl}">`;
                if(data.text) content += `<span>${data.text}</span>`;
                
                msgDiv.innerHTML = content;
                msgBox.appendChild(msgDiv);
            });
            msgBox.scrollTop = msgBox.scrollHeight;
        });

        sendBtn.onclick = sendMessage;
        msgInput.onkeypress = (e) => { if(e.key === 'Enter') sendMessage(); };
    </script>
</body>
</html>
